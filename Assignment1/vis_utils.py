from math import sqrt , ceil
import numpy as np

def visualize_grid(Xs,ubound = 255.0,padding = 1):
	(N,H,W,C) = Xs.shape
	grid_size = int(ceil(sqrt(N)))#ceil函数为下取整
	grid_height = H * grid_size + padding * (grid_size - 1)
	grid_width = W * grid_size + padding * (grid_size - 1)
	grid = np.zeros((grid_height, grid_width,C))
	next_idx = 0
	y0 , y1 = 0 , H
	for i in range(grid_size):
		x0 ,x1 = 0 , W
		for j in range(grid_size):
			if next_idx < N:
				img = Xs[next_idx]
				low , high = np.min(img),np.max(img)
				grid[y0:y1,x0:x1] = (img - low) / (high - low) * ubound
				next_idx += 1
			x0 += W + padding
			x1 += W + padding
		y0 += H +padding
		y1 += H +padding
	return grid